# MCP é›†æˆæŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•é€šè¿‡ MCP (Model Context Protocol) åè®®é›†æˆ Agent Skillsã€‚

## æ¦‚è¿°

Agent Skills æä¾›æ ‡å‡†çš„ MCP Server æ¥å£ï¼Œå¯ä¸ä»»ä½•æ”¯æŒ MCP çš„ AI ç³»ç»Ÿé›†æˆï¼š
- **Cursor** - AI ç¼–ç¨‹åŠ©æ‰‹
- **Claude Desktop** - Anthropic å®˜æ–¹æ¡Œé¢å®¢æˆ·ç«¯
- å…¶ä»– MCP å…¼å®¹å®¢æˆ·ç«¯

---

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼ Aï¼šæœ¬åœ°è¿è¡Œï¼ˆæ¨èå¼€å‘æ—¶ä½¿ç”¨ï¼‰

æ— éœ€ Dockerï¼Œç›´æ¥ä½¿ç”¨ `uv` è¿è¡Œï¼š

```bash
# å®‰è£…ä¾èµ–
uv sync

# å¯åŠ¨ MCP Server
uv run agent-skills-server
```

### æ–¹å¼ Bï¼šDocker è¿è¡Œï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰

```bash
# æ„å»ºé•œåƒ
docker build -t agent-skills:latest -f docker_config/Dockerfile .

# è¿è¡Œ MCP Server
docker run -i --rm \
  -v ~/.agent-skills/skills:/skills \
  agent-skills:latest
```

---

## Cursor é…ç½®

Cursor é€šè¿‡ `~/.cursor/mcp.json` é…ç½® MCP æœåŠ¡å™¨ã€‚

### é…ç½®æ–‡ä»¶ä½ç½®

| ç³»ç»Ÿ | è·¯å¾„ |
|------|------|
| macOS | `~/.cursor/mcp.json` |
| Windows | `%USERPROFILE%\.cursor\mcp.json` |
| Linux | `~/.cursor/mcp.json` |

### é…ç½®ç¤ºä¾‹ 1ï¼šæœ¬åœ°è¿è¡Œï¼ˆæœ€ç®€å•ï¼‰

```json
{
  "mcpServers": {
    "agent-skills": {
      "command": "uv",
      "args": [
        "run",
        "--directory", "/path/to/agent_skills",
        "agent-skills-server"
      ]
    }
  }
}
```

**è¯´æ˜**ï¼š
- ä½¿ç”¨ `uv run` ç›´æ¥å¯åŠ¨ MCP Server
- æ— éœ€ Dockerï¼Œé€‚åˆå¼€å‘è°ƒè¯•
- Skills ç›®å½•ä½¿ç”¨é¡¹ç›®å†…ç½®çš„ `agent_skills/skills/`

### é…ç½®ç¤ºä¾‹ 2ï¼šDocker è¿è¡Œï¼ˆæ¨èï¼‰

```json
{
  "mcpServers": {
    "agent-skills": {
      "command": "docker",
      "args": [
        "run", "-i", "--rm",
        "-v", "~/.agent-skills/skills:/skills",
        "-v", "/Users:/Users",
        "agent-skills:latest"
      ]
    }
  }
}
```

ä¸¤ä¸ªæŒ‚è½½çš„ä½œç”¨ï¼š
- `~/.agent-skills/skills:/skills` - skills ç›®å½•ï¼ˆå¿…éœ€ï¼‰
- `/Users:/Users` - å®¿ä¸»æœºæ–‡ä»¶è®¿é—®ï¼ˆå¯é€‰ï¼Œç”¨äºè„šæœ¬è¯»å†™å¤–éƒ¨æ–‡ä»¶ï¼‰

> ğŸ’¡ Linux ç³»ç»Ÿè¯·å°† `/Users:/Users` æ”¹ä¸º `/home:/home`

### é…ç½®åç”Ÿæ•ˆ

1. ä¿å­˜ `mcp.json` æ–‡ä»¶
2. **å®Œå…¨é‡å¯ Cursor**ï¼ˆCmd+Q / Alt+F4ï¼‰
3. åœ¨ Agent æ¨¡å¼ä¸­éªŒè¯ `skills_*` å·¥å…·æ˜¯å¦å¯ç”¨

---

## Claude Desktop é…ç½®

Claude Desktop é€šè¿‡ `claude_desktop_config.json` é…ç½® MCPã€‚

### é…ç½®æ–‡ä»¶ä½ç½®

| ç³»ç»Ÿ | è·¯å¾„ |
|------|------|
| macOS | `~/Library/Application Support/Claude/claude_desktop_config.json` |
| Windows | `%APPDATA%\Claude\claude_desktop_config.json` |

### é…ç½®ç¤ºä¾‹ 1ï¼šåªæŒ‚è½½æŠ€èƒ½ç›®å½•ï¼ˆçº¯æŠ€èƒ½ç®¡ç†ï¼‰

```json
{
  "mcpServers": {
    "agent-skills": {
      "command": "docker",
      "args": ["run", "-i", "--rm",
               "-v", "~/.agent-skills/skills:/skills",
               "agent-skills:latest"]
    }
  }
}
```

### é…ç½®ç¤ºä¾‹ 2ï¼šæŒ‚è½½å®¿ä¸»æœºç›®å½•ï¼ˆè„šæœ¬å¯è®¿é—®å¤–éƒ¨æ–‡ä»¶ï¼‰

```json
{
  "mcpServers": {
    "agent-skills": {
      "command": "docker",
      "args": ["run", "-i", "--rm",
               "-v", "~/.agent-skills/skills:/skills",
               "-v", "/Users:/Users",
               "agent-skills:latest"]
    }
  }
}
```

ä¸¤ä¸ªæŒ‚è½½çš„ä½œç”¨ï¼š
- `~/.agent-skills/skills:/skills` - skills ç›®å½•ï¼ˆå¿…éœ€ï¼‰
- `/Users:/Users` - å®¿ä¸»æœºæ–‡ä»¶è®¿é—®ï¼ˆå¯é€‰ï¼Œç”¨äºè„šæœ¬è¯»å†™å¤–éƒ¨æ–‡ä»¶ï¼‰

### Windows è·¯å¾„ç¤ºä¾‹

```json
{
  "mcpServers": {
    "agent-skills": {
      "command": "docker",
      "args": ["run", "-i", "--rm",
               "-v", "C:\\Users\\me\\.agent-skills\\skills:/skills",
               "-v", "C:\\Users:/Users",
               "agent-skills:latest"]
    }
  }
}
```

---

## ä¸ºä»€ä¹ˆä½¿ç”¨ Dockerï¼Ÿ

### 1. éš”ç¦»çš„æ‰§è¡Œç¯å¢ƒ

Skills è„šæœ¬å¯èƒ½éœ€è¦å„ç§ä¾èµ–ï¼ˆå¦‚ `pdf2image`ã€`pytesseract`ï¼‰ï¼ŒDocker å®¹å™¨é¢„è£…äº†è¿™äº›å·¥å…·ï¼š

```
Docker å®¹å™¨å†…é¢„è£…ï¼š
â”œâ”€â”€ Python 3.12 + uv
â”œâ”€â”€ poppler-utils (PDF å¤„ç†)
â”œâ”€â”€ tesseract-ocr (OCR)
â”œâ”€â”€ Node.js 20 (JavaScript å·¥å…·)
â””â”€â”€ å¸¸ç”¨ Python åº“
```

### 2. å®‰å…¨æ€§

- Skills è„šæœ¬åœ¨å®¹å™¨å†…æ‰§è¡Œï¼Œä¸ä¼šå½±å“å®¿ä¸»æœº
- åªæœ‰æŒ‚è½½çš„ç›®å½•å¯è¢«è®¿é—®
- å®¹å™¨ä½¿ç”¨åè‡ªåŠ¨é”€æ¯ï¼ˆ`--rm`ï¼‰

### 3. ä¸€è‡´æ€§

- æ— è®ºåœ¨ä»€ä¹ˆç³»ç»Ÿä¸Šè¿è¡Œï¼Œç¯å¢ƒéƒ½ç›¸åŒ
- é¿å…"åœ¨æˆ‘æœºå™¨ä¸Šå¯ä»¥è¿è¡Œ"çš„é—®é¢˜

### 4. ä½•æ—¶ä¸éœ€è¦ Docker

- **å¼€å‘è°ƒè¯•æ—¶**ï¼šä½¿ç”¨ `uv run` æ›´å¿«
- **åªä½¿ç”¨çº¯è®¡ç®—æŠ€èƒ½**ï¼šå¦‚ `gcd-calculator`ã€`prime-list-generator`
- **Agent å·²æœ‰æ–‡ä»¶ç³»ç»Ÿåç«¯**ï¼šå¦‚ DeepAgent çš„ FilesystemMiddleware

---

## ä¸ºä»€ä¹ˆéœ€è¦å®¿ä¸»æœºç›®å½•æŒ‚è½½ï¼Ÿ

### åœºæ™¯åˆ†æ

| åœºæ™¯ | æ˜¯å¦éœ€è¦æŒ‚è½½å®¿ä¸»æœºç›®å½• | åŸå›  |
|------|----------------------|------|
| ä½¿ç”¨ `gcd-calculator` è®¡ç®—æœ€å¤§å…¬çº¦æ•° | âŒ ä¸éœ€è¦ | çº¯è®¡ç®—ï¼Œæ— æ–‡ä»¶æ“ä½œ |
| ä½¿ç”¨ `pdf` æŠ€èƒ½è½¬æ¢ PDF | âœ… éœ€è¦ | éœ€è¦è®¿é—®ç”¨æˆ·çš„ PDF æ–‡ä»¶ |
| åˆ›å»ºæ–°æŠ€èƒ½ | âŒ ä¸éœ€è¦ | æŠ€èƒ½å†™å…¥ `/skills` ç›®å½• |
| åœ¨æŠ€èƒ½ä¸­ç”ŸæˆæŠ¥å‘Šåˆ°ç”¨æˆ·ç›®å½• | âœ… éœ€è¦ | è¾“å‡ºæ–‡ä»¶åˆ°ç”¨æˆ·æŒ‡å®šè·¯å¾„ |

### å®¿ä¸»æœºæŒ‚è½½çš„ä½œç”¨

```
å®¿ä¸»æœº                          Docker å®¹å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /Users/xxx/        â”‚ â”€â”€â”€â”€â”€â”€â–º â”‚ /Users/xxx/        â”‚
â”‚   â”œâ”€â”€ Desktop/     â”‚   -v    â”‚   â”œâ”€â”€ Desktop/     â”‚
â”‚   â”‚   â””â”€â”€ doc.pdf  â”‚         â”‚   â”‚   â””â”€â”€ doc.pdf  â”‚
â”‚   â””â”€â”€ Documents/   â”‚         â”‚   â””â”€â”€ Documents/   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# skills_run ä½¿ç”¨ç»å¯¹è·¯å¾„è®¿é—®ç”¨æˆ·æ–‡ä»¶
skills_run(name="pdf", command="python scripts/convert.py /Users/xxx/Desktop/doc.pdf -o /Users/xxx/Desktop/doc.md")
```

### ä¸æŒ‚è½½å®¿ä¸»æœºç›®å½•æ—¶

- ç®¡ç†å·¥å…·ï¼ˆ`skills_ls`, `skills_read` ç­‰ï¼‰åªèƒ½æ“ä½œ `/skills` ç›®å½•
- `skills_run` è„šæœ¬æ— æ³•è®¿é—®å¤–éƒ¨æ–‡ä»¶
- é€‚åˆçº¯æŠ€èƒ½ç®¡ç†åœºæ™¯

---

## MCP Resources - æ¸è¿›å¼æŠ«éœ²

Skills ä½œä¸º MCP Resource è‡ªåŠ¨æš´éœ²ç»™ Agentï¼Œå®ç°æ¸è¿›å¼æŠ«éœ²ï¼š

```
å¯åŠ¨æ—¶è‡ªåŠ¨è·å–ï¼ˆå…ƒæ•°æ®ï¼‰:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  list_resources() è¿”å›:                                     â”‚
â”‚                                                             â”‚
â”‚  skill://skill-creator                                      â”‚
â”‚    description: ç”¨äºåˆ›å»ºæ–°æŠ€èƒ½çš„å…ƒæŠ€èƒ½                       â”‚
â”‚                                                             â”‚
â”‚  skill://gcd-calculator                                     â”‚
â”‚    description: è®¡ç®—æœ€å¤§å…¬çº¦æ•°                               â”‚
â”‚                                                             â”‚
â”‚  skill://pdf                                                â”‚
â”‚    description: PDF å¤„ç†æŠ€èƒ½                                â”‚
â”‚  ...                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼ Agent åˆ¤æ–­éœ€è¦æ—¶
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  read_resource("skill://skill-creator")                     â”‚
â”‚  â†’ è¿”å›å®Œæ•´ SKILL.md å†…å®¹                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜åŠ¿ï¼š**
- å¯åŠ¨æ—¶åªåŠ è½½æŠ€èƒ½åç§°å’Œæè¿°ï¼ˆè½»é‡ï¼‰
- Agent æŒ‰éœ€è¯»å–å®Œæ•´å†…å®¹ï¼ˆèŠ‚çœ tokenï¼‰
- è‡ªåŠ¨å‘ç°æ–°æ·»åŠ çš„æŠ€èƒ½

---

## MCP Prompt

ç³»ç»Ÿæä¾›ä¸€ä¸ªå†…ç½® Promptï¼ŒåŒ…å«å®Œæ•´çš„æŠ€èƒ½ç³»ç»Ÿä½¿ç”¨æŒ‡å—ï¼š

```python
# MCP å®¢æˆ·ç«¯å¯ä»¥è·å–
get_prompt("skill_guide")
```

è¿”å›çº¦ 200 è¡Œçš„è¯¦ç»†æŒ‡å—ï¼ŒåŒ…æ‹¬ï¼š
- ä»€ä¹ˆæ˜¯æŠ€èƒ½
- ä½•æ—¶ä½¿ç”¨æŠ€èƒ½
- å¦‚ä½•ä½¿ç”¨æŠ€èƒ½ï¼ˆ4 æ­¥æµç¨‹ï¼‰
- æ–‡ä»¶ç³»ç»Ÿè®¿é—®è§„åˆ™
- 6 ä¸ªå·¥å…·é€ŸæŸ¥è¡¨

---

## å‘½ä»¤è¡Œå‚æ•°

```bash
agent-skills-server [OPTIONS]

é€‰é¡¹ï¼š
  --skills-dir, -s PATH    é¢å¤–çš„æŠ€èƒ½ç›®å½•ï¼ˆå¯å¤šæ¬¡æŒ‡å®šï¼‰
  --transport, -t TYPE     ä¼ è¾“åè®®ï¼šstdioï¼ˆé»˜è®¤ï¼‰æˆ– sse
  --quiet, -q              é™é»˜æ¨¡å¼ï¼Œä¸è¾“å‡ºæ—¥å¿—
```

### ç¤ºä¾‹

```bash
# ä½¿ç”¨ SSE ä¼ è¾“
uv run agent-skills-server --transport sse

# æ·»åŠ é¢å¤–æŠ€èƒ½ç›®å½•
uv run agent-skills-server --skills-dir /path/to/custom-skills

# é™é»˜æ¨¡å¼
uv run agent-skills-server --quiet
```

---

## ç¯å¢ƒå˜é‡

| å˜é‡ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `SKILLS_DIR` | `/skills` | æŠ€èƒ½ç›®å½•ï¼ˆå¿…éœ€ï¼‰ |
| `DISABLE_BUILTIN_SKILLS` | `false` | ç¦ç”¨å†…ç½®æŠ€èƒ½åŠ è½½ |

### DISABLE_BUILTIN_SKILLS è¯¦è§£

Docker é•œåƒå†…ç½®äº†å¤šä¸ªç¤ºä¾‹æŠ€èƒ½ï¼ˆgcd-calculator, pdf, coprime-checker ç­‰ï¼‰ã€‚è®¾ç½®æ­¤å˜é‡å¯ä»¥æ§åˆ¶æ˜¯å¦åŠ è½½è¿™äº›å†…ç½®æŠ€èƒ½ï¼š

| è®¾ç½® | å†…ç½®æŠ€èƒ½ï¼ˆgcd-calculator, pdf ç­‰ï¼‰ | skill-creator å…ƒæŠ€èƒ½ |
|-----|----------------------------------|---------------------|
| ä¸è®¾ç½®ï¼ˆé»˜è®¤ï¼‰ | âœ… æ˜¾ç¤ºåœ¨ resources åˆ—è¡¨ä¸­ | âœ… è‡ªåŠ¨å¤åˆ¶åˆ°ç”¨æˆ· /skills |
| `true` | âŒ ä¸æ˜¾ç¤º | âœ… ä»ç„¶è‡ªåŠ¨å¤åˆ¶åˆ°ç”¨æˆ· /skills |

**ä½¿ç”¨åœºæ™¯**ï¼š
- å¸Œæœ›æœ‰ä¸€ä¸ªå¹²å‡€çš„ skills ç›®å½•ï¼ŒåªåŒ…å«è‡ªå·±åˆ›å»ºçš„æŠ€èƒ½
- ä½†ä»ç„¶éœ€è¦ `skill-creator` æ¥æŒ‡å¯¼åˆ›å»ºæ–°æŠ€èƒ½

**é…ç½®ç¤ºä¾‹**ï¼š

```json
{
  "mcpServers": {
    "agent-skills": {
      "command": "docker",
      "args": ["run", "-i", "--rm",
               "-e", "DISABLE_BUILTIN_SKILLS=true",
               "-v", "~/.agent-skills/skills:/skills",
               "-v", "/Users:/Users",
               "agent-skills:latest"]
    }
  }
}
```

### è®¾è®¡ç†å¿µ

- ç®¡ç†å·¥å…·ï¼ˆ`skills_ls`, `skills_read` ç­‰ï¼‰åªæ“ä½œ `/skills` ç›®å½•
- å¤–éƒ¨æ–‡ä»¶è®¿é—®é€šè¿‡ `skills_run` çš„å‘½ä»¤å‚æ•°å’Œå®¿ä¸»æœºç›®å½•æŒ‚è½½å®ç°

---

## å¸¸è§é—®é¢˜

### Q: Cursor é‡å¯å skills å·¥å…·ä¸å¯ç”¨ï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. `mcp.json` è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼ˆJSON æ ¼å¼ï¼‰
2. è·¯å¾„æ˜¯å¦ä½¿ç”¨ç»å¯¹è·¯å¾„
3. ä½¿ç”¨ Cmd+Qï¼ˆmacOSï¼‰æˆ– Alt+F4ï¼ˆWindowsï¼‰å®Œå…¨é€€å‡º Cursorï¼Œè€Œä¸æ˜¯å…³é—­çª—å£

### Q: Docker å®¹å™¨å¯åŠ¨å¤±è´¥ï¼Ÿ

**A**: 
1. ç¡®ä¿ Docker Desktop æ­£åœ¨è¿è¡Œ
2. ç¡®ä¿é•œåƒå·²æ„å»ºï¼š`docker images agent-skills:latest`
3. æ£€æŸ¥æŒ‚è½½è·¯å¾„æ˜¯å¦å­˜åœ¨

### Q: skills_run æ— æ³•è®¿é—®æˆ‘çš„æ–‡ä»¶ï¼Ÿ

**A**: éœ€è¦æŒ‚è½½å®¿ä¸»æœºç›®å½•ï¼š
- macOSï¼šæ·»åŠ  `-v /Users:/Users`
- Linuxï¼šæ·»åŠ  `-v /home:/home`
- ç„¶ååœ¨å‘½ä»¤ä¸­ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œå¦‚ `skills_run(name="pdf", command="python scripts/convert.py /Users/xxx/file.pdf")`

---

## ä¸ Middleware æ–¹å¼å¯¹æ¯”

| ç‰¹æ€§ | MCP | Middleware |
|------|-----|------------|
| åè®® | JSON-RPC over stdio | Python åŸç”Ÿè°ƒç”¨ |
| å»¶è¿Ÿ | è¾ƒé«˜ï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰ | è¾ƒä½ï¼ˆç›´æ¥è°ƒç”¨ï¼‰ |
| é€‚ç”¨åœºæ™¯ | Claude Desktop, Cursor | LangChain/LangGraph åº”ç”¨ |
| ä¾èµ– | mcp, fastmcp | docker (Python SDK) |
| é…ç½®å¤æ‚åº¦ | JSON é…ç½®æ–‡ä»¶ | Python ä»£ç  |

å¦‚æœä½ åœ¨å¼€å‘ LangChain åº”ç”¨ï¼Œå»ºè®®ä½¿ç”¨ [Middleware é›†æˆ](middleware-integration.md)ã€‚
